{% extends 'posts/base.html' %}

{% block title %}Главная - Мой Блог{% endblock %}

{% block content %}
<div class="posts-header">
    <h1>Последние посты</h1>
    <p>Всего постов: {{ posts.count }}</p>
</div>

<div class="posts-list">
    {% for post in posts %}
    <article class="post-card">
        <div class="post-meta">
            <time datetime="{{ post.pub_date|date:'Y-m-d' }}">{{ post.pub_date|date:"d.m.Y H:i" }}</time>
            {% if post.category %}<span class="category">Категория: {{ post.category.name }}</span>{% endif %}
        </div>

        <h2 class="post-title"><a href="{% url 'post-detail' post.pk %}">{{ post.title }}</a></h2>

        {% if post.tags.all %}
        <div class="tags">
            {% for tag in post.tags.all %}<span class="tag">{{ tag.name }}</span>{% endfor %}
        </div>
        {% endif %}

        <div class="post-excerpt">{{ post.content|truncatewords:50 }}</div>
        <a href="{% url 'post-detail' post.pk %}" class="read-more">Читать далее →</a>
    </article>
    {% empty %}
    <div class="no-posts"><p>Пока нет постов.</p></div>
    {% endfor %}
</div>

{% if is_paginated %}
<nav class="pagination">
    {% if page_obj.has_previous %}<a href="?page={{ page_obj.previous_page_number }}">← Назад</a>{% endif %}
    {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}<span class="current">{{ num }}</span>
        {% else %}<a href="?page={{ num }}">{{ num }}</a>{% endif %}
    {% endfor %}
    {% if page_obj.has_next %}<a href="?page={{ page_obj.next_page_number }}">Вперед →</a>{% endif %}
</nav>
{% endif %}

<style>
    .posts-header { text-align: center; margin-bottom: 3rem; }
    .posts-header h1 { color: #333; margin-bottom: 0.5rem; }
    .post-card { background: white; padding: 2rem; margin-bottom: 2rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; }
    .post-card:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(0,0,0,0.15); }
    .post-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; font-size: 0.9rem; color: #666; }
    .category { background: #007bff; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; }
    .post-title { margin-bottom: 1rem; }
    .post-title a { text-decoration: none; color: #333; transition: color 0.3s; }
    .post-title a:hover { color: #007bff; }
    .tags { margin-bottom: 1rem; }
    .tag { display: inline-block; background: #f8f9fa; color: #666; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem; margin-right: 0.5rem; }
    .post-excerpt { color: #666; line-height: 1.6; margin-bottom: 1rem; }
    .read-more { color: #007bff; text-decoration: none; font-weight: 500; }
    .read-more:hover { text-decoration: underline; }
    .no-posts { text-align: center; padding: 3rem; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
</style>
{% endblock %}
